<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SEO AI Writer</title>
    <!-- Thêm CSS để ẩn overlay lỗi -->
    <link rel="stylesheet" href="/disable-overlay.css">
    <style>
      /* CSS để ẩn plugin báo lỗi */
      [plugin\:runtime-error-plugin] {
        display: none !important;
        visibility: hidden !important;
        z-index: -9999 !important;
        position: fixed !important;
        top: -9999px !important;
        left: -9999px !important;
        width: 0 !important;
        height: 0 !important;
        opacity: 0 !important;
      }
    </style>
    <!-- Script sửa lỗi ResizeObserver - được tải trước tất cả các script khác -->
    <script src="/fix-resize-observer.js"></script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module">
      // Biến toàn cục để vô hiệu hóa plugin hiển thị lỗi
      window.__RUNTIME_ERROR_OVERLAY_ACTIVE = false;
      
      // Lọc các lỗi liên quan đến ResizeObserver và Facebook SDK
      window.__RUNTIME_ERROR_FILTER_FN = function(error) {
        if (!error || !error.message) return false;
        return error.message.includes('ResizeObserver loop') || 
               error.message.includes('ResizeObserver is not defined') ||
               error.message.includes('Failed to fetch') && error.stack && error.stack.includes('facebook.net') ||
               error.message.includes('getLoginStatusCORS') ||
               error.message.includes('connect.facebook.net');
      };
      
      // Gọi hàm ẩn overlay lỗi
      if (window.__HIDE_ALL_ERROR_OVERLAYS) {
        window.__HIDE_ALL_ERROR_OVERLAYS();
      }
      
      // Xử lý lỗi Facebook SDK CORS
      window.addEventListener('error', function(event) {
        if (event.error && event.error.message && 
            (event.error.message.includes('Failed to fetch') && 
             event.error.stack && event.error.stack.includes('facebook.net'))) {
          console.log('Error retrieving login status, fetch cancelled.');
          event.preventDefault();
          event.stopImmediatePropagation();
          return false;
        }
      });
      
      // Xử lý unhandled promise rejections từ Facebook SDK
      window.addEventListener('unhandledrejection', function(event) {
        if (event.reason && event.reason.message && 
            (event.reason.message.includes('Failed to fetch') && 
             event.reason.stack && event.reason.stack.includes('facebook.net'))) {
          console.log('Error retrieving login status, fetch cancelled.');
          event.preventDefault();
          return false;
        }
      });
    </script>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>